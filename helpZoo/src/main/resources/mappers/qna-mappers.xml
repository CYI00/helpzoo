<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="qnaMapper">
	
	<!-- resultMap : 필드, 컬럼 매핑  -->
	<resultMap type="QNABoard" id="qnaBoardResultSet">
        <id property="qnaNo" column="QNA_NO"/>
        <result property="originNo" column="ORIGINNO"/>
        <result property="groupOrd" column="GROUPORD"/>
        <result property="groupLayer" column="GROUPLAYER"/>
        <result property="qnaTitle" column="QNA_TITLE"/>
        <result property="qnaContent" column="QNA_CONTENT"/>
        <result property="readCount" column="READ_COUNT"/>
        <result property="qnaCreateDate" column="QNA_CREATE_DT"/>
        <result property="qnaModifyDate" column="QNA_MODIFY_DT"/>
        <result property="qnaWriter" column="MEMBER_ID"/>
    </resultMap>
    
    <resultMap type="Attachment" id="attachmentResultSet">
    	<id property="fileNo" column="FILE_NO"/>
    	<result property="parentBoardNo" column="PARENT_BOARD_NO"/>
    	<result property="fileOriginName" column="FILE_ORIGIN_NAME"/>
    	<result property="fileChangeName" column="FILE_CHANGE_NAME"/>
    	<result property="filePath" column="FILE_PATH"/>
    	<result property="fileLevel" column="FILE_LEVEL"/>
    </resultMap>
    
    <!-- 게시글 수 조회 -->
    <select id="getListCount" resultType="_int">
    SELECT COUNT(*) FROM QNA_BOARD 
    </select>
    
    <!-- 게시글 목록 조회 -->
    <select id="selectList" resultMap="qnaBoardResultSet">
    	SELECT * FROM Q_BOARD 
    </select>
    
    <select id="selectNextNo" resultType="_int">
    SELECT SEQ_QNO.NEXTVAL FROM DUAL
    </select>
    
    <insert id="insertBoard" parameterType="qnaBoard">
    	INSERT INTO QNA_BOARD(#{qnaNo}, #{qnaNo}, 0, 0, #{qnaTitle},
    	#{qnaContent}, DEFAULT, DEFAULT, DEFAULT, #{qnaWriter})
    </insert>
  
  <!-- 파일 정보 삽입 -->
  	<insert id="insertAttachment" parameterType="Attachment">
  	INSERT INTO Q_ATTACHMENT VALUES(
			SEQ_QFNO.NEXTVAL, #{parentBoardNo}, #{fileOriginName}, #{fileChangeName}, #{filePath}, #{fileLevel}
			)
  	</insert>
</mapper>
